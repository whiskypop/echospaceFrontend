<view class="container">
  <scroll-view class="content" scroll-y>
    <!-- 礼物部分 -->
    <view class="gift-card">
      <video src="{{carts[0].video}}" autoplay muted loop controls="{{false}}" class="main-content" data-cart="{{carts[0]}}" bindtap="showGiftPopup" />
      <view class="sub-content" wx:if="{{cartsNumber >= 2}}">
        <view wx:for="{{subcarts}}" wx:key="*this">
          <video src="{{item.video}}" autoplay muted loop controls="{{false}}" data-cart="{{item}}" bindtap="showGiftPopup">
          </video>
        </view>
      </view>
      <view class="blessings">
        <view class="blessingText">{{audioInfo.blessing}}</view>
      </view>
    </view>
    <!-- <view class="benefits-section">
      <text class="section-title">权益礼物</text>
      <scroll-view class="benefits-scroll" scroll-x="true">
        <view class="benefit-item" wx:for="{{benefits}}" wx:key="index"> -->
    <!-- 点击礼物触发toggleGiftPopup方法 -->
    <!-- <video src="{{item.video}}" class="benefit-video" loop autoplay muted show-play-btn="{{false}}" controls="{{false}}" bindtap="showGiftPopup" data-index="{{index}}"></video>
          <view class="benefit-details">
            <text class="benefit-name">{{item.name}}</text>
          </view>
        </view>
      </scroll-view>
    </view> -->

    <view class="section">
      <view class="music-card">
        <view class="background">
          <image class="backgroundImage" src="{{image_url}}" />
          <!-- <view class="test"></view> -->
        </view>
        <view class="content">
          <image class="music-image" src="{{image_url}}" />
          <view class="music-info">
            <text class="music-title">{{audioInfo.title}}</text>
            <scroll-view class="lyric-scroll" scroll-y="true">
              <text class="lyric">{{audioInfo.lyric}}</text>
            </scroll-view>
          </view>
          <view class="music-controls">
            <!-- 进度条 -->
            <view class="slider-container">
              <text class="time">{{formattedCurrentTime}}</text>
              <slider class="custom-slider" min="0" max="{{duration}}" block-size="12px" value="{{currentTime}}" activeColor="#fff" backgroundColor="#e9e9e9" bindchanging="handleSliderChanging" bindchange="seekMusic" />
              <text class="time">{{formattedDuration}}</text>
            </view>
            <button class="music-play-button" bindtap="toggleMusicPlay">
              <image src="{{isMusicPlaying ? 'cloud://echospace-mateials-9d8r8fc399ddf.6563-echospace-mateials-9d8r8fc399ddf-1326484866/icons/pause.png' : 'cloud://echospace-mateials-9d8r8fc399ddf.6563-echospace-mateials-9d8r8fc399ddf-1326484866/icons/play.png'}}" class="music-play-icon" />
            </button>
          </view>
          <button class="expand-button" bindtap="goToMusicPage">⤢</button>
        </view>

      </view>
      <text class="label">音乐贺卡</text>
    </view>

    <!-- 礼物弹出框 -->
    <view class="gift-popup {{showGiftPopup ? 'show-popup' : ''}}">
      <view class="gift-popup-content">
        <video class="gift-video" src="{{selectedGift.video}}" muted autoplay loop controls="{{false}}"></video>
        <view class="gift-controls">
          <!-- <button class="play-button" bindtap="toggleGiftAudio">
            <image src="{{isGiftPlaying ? 'cloud://echospace-mateials-9d8r8fc399ddf.6563-echospace-mateials-9d8r8fc399ddf-1326484866/icons/pause.png' : 'cloud://echospace-mateials-9d8r8fc399ddf.6563-echospace-mateials-9d8r8fc399ddf-1326484866/icons/play.png'}}" class="play-icon" />
          </button> -->
          <view class="giftDetails">
            <text class="gift-description">{{selectedGift.name}}</text>
            <view class="showCode-wrapper">
              <view class="showCode">查看</view>
            </view>

          </view>
        </view>
        <!-- 添加条形码图片 -->
        <!-- <image src="cloud://cloud1-5gmggv5l8f2ead23.636c-cloud1-5gmggv5l8f2ead23-1326484866/backgroundImage/scanbar.png" class="barcode-image" mode="widthFix"></image> -->
        <button class="gift-close-button" bindtap="closeGiftPopup">Close</button>
      </view>
    </view>
  </scroll-view>
  <view class="footer">
    <button class="share-button" bindtap="showSharePopup">分享</button>
  </view>

  <!-- Share Popup -->
  <view class="share-popup" wx:if="{{showPopup}}">
    <view class="popup-content">
      <image src="cloud://echospace-mateials-9d8r8fc399ddf.6563-echospace-mateials-9d8r8fc399ddf-1326484866/videos&images/sharePopup.png" class="shareToMedia"></image>
      <button class="close-button" bindtap="hideSharePopup">×</button>
    </view>
  </view>
  <!-- <view class="overlay" wx:if="{{showGiftPopup || showPopup}}"></view> -->
</view>